@using System.Web.Optimization
@using STP.Domain
@using PagedList.Mvc
@model PagedList.IPagedList<STP.Domain.RoadNetwork.Constraint.ConstraintModel>


@{
    Layout = null;

    int userTypeID = 0;
    long orgId = 0;
    if (Session["UserInfo"] != null)
    {
        var sessionValues = (STP.Domain.SecurityAndUsers.UserInfo)Session["UserInfo"];
        userTypeID = sessionValues.UserTypeId;
        orgId = sessionValues.OrganisationId;
    }
    int pageSize = 5;
    int? pageNum = ViewBag.page;
    string ConstraintID = Convert.ToString(ViewBag.ConstraintID);
    bool flageditmode = ViewBag.flageditmode;
}
<!DOCTYPE html>
<html lang="en">
<head>

</head>
<body>
    <div id="soa-structure-detail" class="show-history-list">
        <style>
            #exampleModalCenter1 {
                position: fixed;
                top: 0;
                left: 0;
                z-index: 1050;
                /* display: none; */
                width: 100%;
                height: 100%;
                /* overflow: hidden; */
                outline: 0;
                overflow-x: hidden;
                overflow-y: auto;
            }

            #soa-modal #model-container {
                /*  margin-top: 8rem;
            margin-left: 4rem;*/
                overflow: auto;
            }

            #soa-modal .main-table th {
                background-color: rgb(233 238 244) !important;
                border-radius: 0;
            }
        </style>
        @Html.Hidden("ConstraintID", ConstraintID)
        @Html.Hidden("flageditmode", flageditmode)
        @Html.Hidden("page", pageNum)
        @Html.Hidden("pagesize", pageSize)
        <section id="banner" class="map-icons">

            <!-- Modal -->
            <div id="soa-modal">
                <div tabindex="-1" role="dialog" id="exampleModalCenter1">
                    @*<div class="triangle-right" style="position: absolute; margin-top: 32rem;margin-left: 36.3rem"></div>*@
                    <div id="model-container" class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header pt-4">

                                <span class="details"> Constraint/Caution History</span>


                                <span aria-hidden="true" class="close btn-close-history" data-dismiss="modal" aria-label="Close" style="cursor: pointer">&times;</span>

                            </div>
                            <div class="modal-body pt-4">
                                <div class="row ml-0 pt-2">
                                    <div class="col-lg-12 col-md-12 col-sm-12 pr-4">
                                        <div class="main-table" id="portal-table" style="border-radius: 0; word-wrap:unset">
                                            <table>
                                                <tr>
                                                    <th style="width: 30%;">&nbsp;  <label>Date And Time</label></th>
                                                    <th style="width: 20%;"><label>User Name</label></th>
                                                    <th style="width: 100%;">@Resources.Resource.Details</th>
                                                </tr>
                                                <!-- sample examples -->
                                                @foreach (var item in Model)
                                                {
                                                    <tr>
                                                        <td class="text-color1" style="padding-left: 15px;">
                                                            @item.OccurredTime
                                                        </td>
                                                        <td class="text-color1">
                                                            @item.FirstName
                                                        </td>
                                                        <td class="text-color1">
                                                            @item.HistoryDetails
                                                        </td>
                                                    </tr>
                                                }
                                                @if (ViewBag.TotalCount == 0)
                                                {
                                                    <tr>

                                                        <td colspan="4" style="text-align: center">
                                                            <span style="color: red">No records found</span>
                                                        </td>
                                                    </tr>
                                                }
                                                <!--end sample examples -->
                                            </table>
                                        </div>
                                        @if (Model.Count > 0)
                                        {
                                            <div class="flexer justify-content-center">
                                                <div class="bottom-pagination pl-0 pr-0">
                                                    <div class="pagination" id="reviewCausionPaginator">

                                                        @Html.PagedListPager(Model, page => Url.Action("ConstraintHistoryPopUp",
                                                        new
                                                        {
                                                            page,
                                                            ConstraintID= ViewBag.ConstraintID,
                                                            pageSize=  pageSize
                                                            //B7vy6imTleYsMr6Nlv7VQ =
                                                            //STP.Web.Helpers.EncryptionUtility.Encrypt()
                                                        }),
                                                        new PagedListRenderOptions
                                                        {
                                                            DisplayLinkToPreviousPage = PagedListDisplayMode.IfNeeded,
                                                            DisplayLinkToNextPage = PagedListDisplayMode.IfNeeded,
                                                            LinkToPreviousPageFormat = "<img src='/Content/assets/images/left-chevlon.svg' width='10'>",
                                                            LinkToNextPageFormat = "<img src='/Content/assets/images/right-chevlon.svg' width='10'>",
                                                            DisplayLinkToFirstPage = PagedListDisplayMode.Never,
                                                            DisplayLinkToLastPage = PagedListDisplayMode.Never,
                                                            MaximumPageNumbersToDisplay = 3,
                                                            DisplayEllipsesWhenNotShowingAllPageNumbers = true,
                                                            EllipsesFormat = "..."
                                                        })
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                        @if (ViewBag.Helpdest_redirect != "true")
                                        {
                                            if (userTypeID != 696001)
                                            {
                                                if (ViewBag.orgId == orgId)
                                                {
                                                    <div class="flexer justify-content-center mt-4">
                                                        <button class="btn outline-btn-primary pl-2 pr-2 pt-1 pb-1 btn-rc-review-caution" style="margin-right: 14px;">CAUTIONS</button>
                                                        <button class="btn outline-btn-primary pl-2 pr-2 pt-1 pb-1 btn-rc-view-history">HISTORY</button>
                                                    </div>

                                                }
                                            }
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</body>
</html>


