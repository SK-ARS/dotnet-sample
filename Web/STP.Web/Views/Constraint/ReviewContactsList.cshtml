@using System.Web.Optimization
@using PagedList.Mvc
@model PagedList.IPagedList<STP.Domain.RoadNetwork.Constraint.ConstraintContactModel>
@{
    Layout = null;

    int userTypeID = 0;
    long orgId = 0;
    if (Session["UserInfo"] != null)
    {
        var sessionValues = (STP.Domain.SecurityAndUsers.UserInfo)Session["UserInfo"];
        userTypeID = sessionValues.UserTypeId;
        orgId = sessionValues.OrganisationId;
    }
    int pageSize = 5;
    int? pageNum = ViewBag.page;
    string ConstraintID = Convert.ToString(ViewBag.ConstraintID);
    bool flageditmode = ViewBag.flageditmode;
}

<!DOCTYPE html>
<html lang="en">
<head>

</head>

<body>
    <div id="soa-structure-detail" class="review-contact-list">
        <style>
                #exampleModalCenter1 {
                    position: fixed;
                    top: 0;
                    left: 0;
                    z-index: 1050;
                    /* display: none; */
                    width: 100%;
                    height: 100%;
                    /* overflow: hidden; */
                    outline: 0;
                    overflow-x: hidden;
                    overflow-y: auto;
                }

                #soa-modal #model-container {
                    /*  margin-top: 8rem;
            margin-left: 4rem;*/
                    overflow: auto;
                }

                #soa-modal .main-table th {
                    background-color: rgb(233 238 244) !important;
                    border-radius: 0;
                }
        </style>
        @Html.Hidden("ConstraintID", ConstraintID)
        @Html.Hidden("flageditmode", flageditmode)

        <!--main content -->
        <section id="banner" class="map-icons">

            <!-- Modal -->
            <div id="soa-modal">
                <div tabindex="-1" role="dialog" id="exampleModalCenter1">
                    @*<div class="triangle-right" style="position: absolute; margin-top: 32rem;margin-left: 36.3rem"></div>*@
                    <div id="model-container" class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header pt-4">
                                @if (ViewBag.Helpdest_redirect != "true")
                                {
                                    if (ViewBag.flageditmode == true)
                                    {
                                        if (userTypeID != 696001)
                                        {
                                            if (ViewBag.orgId == orgId)
                                            {
                                                <span class="details">
                                                    <button class="btn outline-btn-primary pl-2 pr-2 pt-1 pb-1 btn-create-constraint-contact">
                                                        + ADD
                                                        CONTACT
                                                    </button>
                                                </span>
                                            }
                                            else
                                            {
                                                <span style="font-family: lato_light;font-size:22px;white-space:nowrap;"> Review contacts</span>

                                            }
                                        }
                                        else
                                        {
                                            <span style="font-family: lato_light;font-size:22px;white-space:nowrap;"> Review contacts</span>

                                        }
                                    }

                                }
                                else
                                {
                                    <span class="details"> Review contacts</span>
                                }

                                <span aria-hidden="true" class="close btn-rc-close" data-dismiss="modal" aria-label="Close" style="cursor: pointer">&times;</span>

                            </div>
                            <div class="modal-body pt-4">
                                <div class="row ml-0 pt-2">
                                    <div class="col-lg-12 col-md-12 col-sm-12 pr-4">
                                        <div class="main-table" id="portal-table" style="border-radius: 0;">
                                            <table>
                                                <tr>
                                                    <th style="width: 30%;">Owner</th>
                                                    <th style="width: 25%;">Name</th>
                                                    <th>Description</th>
                                                    <th style="width:15%;"></th>
                                                </tr>
                                                @if (Model.Count == 0)
                                                {
                                                    <tr>
                                                        <td colspan="4" style="text-align: center">
                                                            <span style="color: red">No records found</span>
                                                        </td>
                                                    </tr>
                                                }
                                                else
                                                {
                                                    foreach (var item in Model)
                                                    {
                                                        <tr>
                                                            <td class="text-color1">@item.OrganisationName</td>
                                                            <td class="text-color1 btn-constraint-coantact-view" style="cursor: pointer; color: blue; text-decoration: underline;"
                                                                data-contactno="@item.ContactNo" data-constraintid="@item.ConstraintId">
                                                                @item.FullName
                                                            </td>
                                                            <td class="text-color1">@item.Description</td>
                                                            <td id="table-head">
                                                                @if (ViewBag.Helpdest_redirect != "true")
                                                                {
                                                                    if (ViewBag.flageditmode == true)
                                                                    {
                                                                        if (userTypeID != 696001)
                                                                        {
                                                                            <a href="#" class="btn-rc-edit-contact" data-contactno="@item.ContactNo"
                                                                               data-constraintid="@item.ConstraintId">
                                                                                <img src="~/Content/assets/images/edit-icon.svg" width="20" class="mr-3">
                                                                            </a>
                                                                            <a href="#" class="btn-rc-delete-contact-warning" id="@item.ContactNo" name="@item.OrganisationName" data-constraintid="@item.ConstraintId">
                                                                                <img src="~/Content/assets/images/delete-icon.svg" width="20">
                                                                            </a>
                                                                        }
                                                                    }
                                                                }
                                                            </td>
                                                        </tr>
                                                    }
                                                }

                                            </table>
                                        </div>
                                        @if (Model.Count > 0)
                                        {
                                            <div class="flexer justify-content-center">
                                                <div class="bottom-pagination pl-0 pr-0">
                                                    <div class="pagination" id="reviewCausionPaginator">

                                                        @Html.PagedListPager(Model, page => Url.Action("ReviewContactsList",
                                                        new
                                                        {
                                                            page = page,
                                                            pageSize = pageSize,
                                                            constraintId = ViewBag.ConstraintID
                                                        }),
                                                        new PagedListRenderOptions
                                                        {
                                                            DisplayLinkToPreviousPage = PagedListDisplayMode.IfNeeded,
                                                            DisplayLinkToNextPage = PagedListDisplayMode.IfNeeded,
                                                            LinkToPreviousPageFormat = "<img src='/Content/assets/images/left-chevlon.svg' width='10'>",
                                                            LinkToNextPageFormat = "<img src='/Content/assets/images/right-chevlon.svg' width='10'>",
                                                            DisplayLinkToFirstPage = PagedListDisplayMode.Never,
                                                            DisplayLinkToLastPage = PagedListDisplayMode.Never,
                                                            MaximumPageNumbersToDisplay = 3,
                                                            DisplayEllipsesWhenNotShowingAllPageNumbers = true,
                                                            EllipsesFormat = "..."
                                                        })
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                        @if (ViewBag.Helpdest_redirect != "true")
                                        {
                                            if (userTypeID != 696001)
                                            {
                                                if (ViewBag.orgId == orgId)
                                                {
                                                    <div class="flexer justify-content-center mt-4">
                                                        <button class="btn outline-btn-primary pl-2 pr-2 pt-1 pb-1 btn-rc-review-caution" style="margin-right: 14px;">CAUTIONS</button>
                                                        <button class="btn outline-btn-primary pl-2 pr-2 pt-1 pb-1 btn-rc-view-history">HISTORY</button>
                                                    </div>

                                                }
                                            }
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="modal fade" id="confirmDeleteMsg" tabindex="-1" role="dialog"
             aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header pt-0">

                    </div>
                    <div class="modal-body pt-0">
                        <img src="~/Content/assets/images/warning-icon2.svg" width="30" />
                        <div class="edit-normal">

                            Do you want to delete the Contact ?
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary btn-rc-cancel-confirmation" data-bs-dismiss="modal">NO</button>
                        <button type="button" class="btn btn-secondary btn-rc-delete-contact-1" data-bs-dismiss="modal">YES</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="successMsg" tabindex="-1" role="dialog"
             aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header pt-0">
                    </div>
                    <div class="modal-body">
                        <img src="~/Content/assets/images/completed.svg"   width="30">
                        <div class="edit-normal">Contact deleted successfully</div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary btn-rc-reload-review-contact" data-bs-dismiss="modal">OK</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="failMsg" tabindex="-1" role="dialog"
             aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header pt-0">
                    </div>
                    <div class="modal-body">
                        <img src="~/Content/assets/images/warning-icon2.svg" width="30">
                        <div class="edit-normal">Deletion Failed</div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">OK</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="~/Scripts/Caution/ifx.Caution-1.0.1.js?V@(Session["ProjectVersion"])"></script>
    <script src="~/Scripts/Constraint/ReviewContactsList.js?V@(Session["ProjectVersion"])"></script>
    <script src="~/Scripts/Constraint/ViewConstraint.js?V@(Session["ProjectVersion"])"></script>
    <script src="~/Scripts/Constraint/HaulierConstraintDetails.js?V@(Session["ProjectVersion"])"></script>
</body>
</html>
