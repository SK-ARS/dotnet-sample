@using System.Web.Optimization
@using STP.Domain
@using PagedList.Mvc
@model PagedList.IPagedList<STP.Domain.RoadNetwork.RoadOwnership.RoadOwnershipOrgSummary>
@{
    int userTypeID = 0;
    bool isAdmin = false;
    int portalType = 0;
    if (Session["UserInfo"] != null)
    {
        var sessionValues = (STP.Domain.SecurityAndUsers.UserInfo)Session["UserInfo"];
        userTypeID = sessionValues.UserTypeId;
        portalType = sessionValues.UserTypeId;
        if (portalType == 696006 || sessionValues.IsAdmin == 1)
        {
            isAdmin = true;
        }
    }
    ViewBag.PageMenuName = (int)STP.Common.Enums.WebMenuEnum.ROADS;
}
@{int searchFlag = ViewBag.searchFlag;
    int pageSize = ViewBag.pageSize;
    int? pageNum = ViewBag.page;
    string SearchString = ViewBag.OrgSearchString;
    @Html.Hidden("searchFlag", searchFlag)
    @Html.Hidden("pageSizeVal", pageSize)
    @Html.Hidden("pageNum", pageNum)
    @Html.Hidden("hdnSearchString", SearchString)

}
<script src="@Url.Content("~/Scripts/jquery-1.9.1.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-ui-1.10.3.min.js")" type="text/javascript"></script>
<script src="~/Scripts/RoadOwnership/jQuery.roadOwnershipOrglist.js?V@(Session["ProjectVersion"])"></script>


<style>
    .maintable {
        width: 100% !important;
        margin-top: 0px !important;
    }

    .trstyle {
        border-bottom: 1px solid #ccc !important;
    }

    .tdstyle {
        text-align: left !important;
    }

    .tdcenter {
        text-align: center !important;
    }

    .noresult {
        color: red !important;
    }

    .spanblack {
        color: black !important;
    }
</style>

<link href="~/Content/Style/Common/alertbox.css" rel="stylesheet" />
<link href="~/Content/Style/Common/style.css" rel="stylesheet" />
<link href="~/Content/Style/Common/grid_css.css" rel="stylesheet" />
<link href="~/Content/Style/Common/PagedList.css" rel="stylesheet" />
<div class="form form_component">
    <div class="head headgrad head_component">
        <div class="dyntitle">@Resources.Resource.OrganisationList</div>
        <span aria-hidden="true" data-icon="&#xe0f3;" id="span-close"></span>
        <form action="../Generic/HelpBuilder" id="form_html_helpbuilder" method="post" novalidate="novalidate" style="width:auto !important;float:right;" target="_blank">
            @if (isAdmin)
            {
                <span id="span-Edit_help" title="Create Help"></span>
            }
            <input id="url_html" name="url" type="hidden" value="">
            <input id="flag" name="flag" type="hidden" value="">
        </form>
        <span id="span-help" title="Help"></span>
    </div>
    <div class="body" id="div_ownership_org">
        <span class="PopupHelpName" id="OrganisationList"></span>
        <div id="form_ChangePassword">
            <div id="div_grid_org_list">
                <table class="maintable">
                    <tr>
                        <th>
                            <span class="keyword">@Resources.Resource.Keyword:</span> @Html.TextBox("orgName", null, new { @id = "orgName" })
                            <button type="button" id="IDSearchOrganisation" class="btnheight27 btngrad btnrds btnbdr" aria-hidden="true" data-icon="&#xe07f;">@Resources.Resource.Search</button>
                        </th>
                        <th colspan="3" class=""></th>
                    </tr>
                    <tr>
                        <th class="headgrad">@Resources.Resource.Name</th>
                        <th class="headgrad"></th>
                    </tr>
                    @foreach (var item in Model)
                    {
                        <tr class="trstyle">
                            <td class="tdstyle">
                                @item.OrganisationName
                            </td>
                            <td style="text-align: right;">
                                <button aria-hidden="true" data-icon="&#xe0f4;" type="button" value="" id="btn_select" class=" btngrad btnrds btnbdr SelectOrgnaisation"
                                        DataorganisationName="@item.OrganisationName" DataorganisationId="@item.OrganisationId">
                                    @Resources.Resource.Select
                                    </button>@Html.Hidden("hdnorganisationId", @item.OrganisationId)
                                </td>
                            </tr>
                        }
                    @if (ViewBag.TotalCount == 0)
                    {
                        <tr>
                            <td class="tdcenter" colspan="2"><span id="noresult" class="noresult">@Resources.Resource.NoResultFound</span></td>
                        </tr>
                    }
                    <tr>
                        <td>
                            <span class="spanblack"></span>
                        </td>
                        <td></td>
                    </tr>

                </table>
                <br />
                @if (ViewBag.TotalCount > 0)
                {
                    <span class="pageSizeSelector">
                        <span class="pagination_span">Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount</span>
                        @Html.PagedListPager(Model, page => Url.Action("ListRoadOwnerOrg",
                        new
                        {
                            B7vy6imTleYsMr6Nlv7VQ =
                                         STP.Web.Helpers.EncryptionUtility.Encrypt("page=" + page +
                                         "&pageSize=" + pageSize +
                                         "&SearchString=" + SearchString)
                        }))
                    </span>
                    <span class="pagination_span">@Resources.Resource.NumberOfItemsToDisplayPerPage :</span>
                    <select id="pageSizeSelect" onchange="changePageSize(this)">
                        <option id="10">10</option>
                        <option id="20">20</option>
                        <option id="50">50</option>
                        <option id="100">100</option>
                    </select>
                    <br />
                    <span class="pageSizeSelector"></span>
                }
                @Html.Hidden("TotalPages", Model.PageCount)
            </div>
        </div>
    </div>
</div>

<script src="~/Scripts/RoadOwnership/ListRoadOwnerOrg.js?V@(Session["ProjectVersion"])"></script>
