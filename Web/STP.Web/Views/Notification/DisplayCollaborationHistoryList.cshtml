@using PagedList.Mvc
@model PagedList.IPagedList<STP.Domain.MovementsAndNotifications.Notification.CollaborationModel>

@{
    int pageNum = 10;
    int documentid = ViewBag.DocumentId;

    if (ViewBag.pageSize != null)
    {
        pageNum = ViewBag.pageSize;
    }
    if (!Request["lang"].IsEmpty())
    {
        Culture = UICulture = Request["lang"];
    }
    if (ViewBag.SORTCollab != true)
    {
        Layout = null;
    }
    int ctr = 0;
}

<div id="exampleModalCenter3" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document" style="margin: auto;">
        <div class="modal-content" style="width: inherit;height: auto;">
            <div class="modal-header pt-2" style="justify-content: end;">
                <span aria-hidden="true" class="close" data-dismiss="modal" aria-label="Close" id="closeViewCollab">&times;</span>
            </div>
            <div class="modal-body pt-0">
                <div class="row mb-1 pb-3">
                    <span class="text-normal pr-2 text-align-center"
                          style="font-family: lato_light; font-size: 25px; margin-top: -2rem; width: 91%;">
                        Collaboration status history
                    </span>
                </div>
                <div class="pl-3 pr-3">
                    <div class="main-table">
                        <table>
                            <tr>
                                <th>
                                    Contact name<span>
                                        <img src="~/Content/assets/images/down-chevlon.svg" width="15"
                                             height="6">
                                    </span>
                                </th>
                                <th>Organisation</th>
                                <th>Date and time</th>
                                <th>External collab<br> status</th>
                                <th>Internal collab <br>status</th>
                            </tr>

                            @foreach (var item in Model)
                            {
                                if (ctr % 2 == 0)
                                {
                                    <tr class="bgColor3">
                                        <td class="text-color1"> @Html.DisplayFor(modelItem => item.FirstName) @Html.DisplayFor(modelItem => item.SurName)</td>
                                        <td class="text-color1">@Html.DisplayFor(modelItem => item.OrganisationName)</td>

                                        <td class="text-color1">
                                            @if (item.WHEN.ToString("dd-MM-yyyy") != "01-01-0001")
                                            {
                                                @item.WHEN.ToString("dd/MM/yyyy HH:mm:ss")
                                            }
                                        </td>
                                        <td class="text-color1">
                                            @if (!string.IsNullOrEmpty(item.ExternalCollaboratonStatus))
                                            {
                                                @item.ExternalCollaboratonStatus.ToLower().Substring(0, 1).ToUpper()<span>@item.ExternalCollaboratonStatus.ToLower().Substring(1).ToLower()</span>
                                            }

                                        </td>
                                        <td class="text-color1">
                                            @if (!string.IsNullOrEmpty(item.InternalCollaborationStatus))
                                            {
                                                @item.InternalCollaborationStatus.ToLower().Substring(0, 1).ToUpper()<span>@item.InternalCollaborationStatus.ToLower().Substring(1).ToLower()</span>
                                            }
                                        </td>

                                    </tr>
                                    if (!string.IsNullOrEmpty(item.ExternalNotes))
                                    {
                                        <tr class="bgColor3">
                                            <td colspan="7">
                                                <div id="notesFromHaulier">
                                                    <div class="pt-3 pb-2">
                                                        <h3 class="heading-medium">External notes</h3>
                                                    </div>
                                                    <div style="width: 70%;">

                                                        <p class="edit-normal pl-0 pr-0 pb-3 pt-0 mt-0 mb-0 ml-0 mr-0"> @Html.DisplayFor(modelItem => item.ExternalNotes)</p>


                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    }

                                    if (!string.IsNullOrEmpty(item.InternalNotes))
                                    {
                                        <tr class="bgColor3">
                                            <td colspan="7">
                                                <div id="notesFromHaulier">
                                                    <div class="pt-3 pb-2">
                                                        <h3 class="heading-medium">@Resources.Resource.InternalNotes</h3>
                                                    </div>
                                                    <div style="width: 70%;">
                                                        <p class="edit-normal  pl-0 pr-0 pb-3 pt-0 mt-0 mb-0 ml-0 mr-0"> @Html.DisplayFor(modelItem => item.InternalNotes)</p>

                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    }

                                }
                                else
                                {
                                    <tr class="bgColor3">
                                        <td class="text-color1"> @Html.DisplayFor(modelItem => item.FirstName) @Html.DisplayFor(modelItem => item.SurName)</td>
                                        <td class="text-color1">@Html.DisplayFor(modelItem => item.OrganisationName)</td>

                                        <td class="text-color1">
                                            @if (item.WHEN.ToString("dd-MM-yyyy") != "01-01-0001")
                                            {
                                                @item.WHEN.ToString("dd/MM/yyyy HH:mm:ss")
                                            }
                                        </td>
                                        <td class="text-color1">
                                            @if (!string.IsNullOrEmpty(item.ExternalCollaboratonStatus))
                                            {
                                                @item.ExternalCollaboratonStatus.ToLower().Substring(0, 1).ToUpper()<span>@item.ExternalCollaboratonStatus.ToLower().Substring(1).ToLower()</span>
                                            }

                                        </td>
                                        <td class="text-color1">
                                            @if (!string.IsNullOrEmpty(item.InternalCollaborationStatus))
                                            {
                                                @item.InternalCollaborationStatus.ToLower().Substring(0, 1).ToUpper()<span>@item.InternalCollaborationStatus.ToLower().Substring(1).ToLower()</span>
                                            }
                                        </td>

                                    </tr>
                                    if (!string.IsNullOrEmpty(item.ExternalNotes))
                                    {
                                        <tr class="bgColor3">
                                            <td colspan="7">
                                                <div id="notesFromHaulier">
                                                    <div class="pt-3 pb-2">
                                                        <h3 class="heading-medium">External notes</h3>
                                                    </div>
                                                    <div style="width: 70%;">

                                                        <p class="edit-normal pl-0 pr-0 pb-3 pt-0 mt-0 mb-0 ml-0 mr-0"> @Html.DisplayFor(modelItem => item.ExternalNotes)</p>


                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    }

                                    if (!string.IsNullOrEmpty(item.InternalNotes))
                                    {
                                        <tr class="bgColor3">
                                            <td colspan="7">
                                                <div id="notesFromHaulier">
                                                    <div class="pt-3 pb-2">
                                                        <h3 class="heading-medium">@Resources.Resource.InternalNotes</h3>
                                                    </div>
                                                    <div style="width: 70%;">
                                                        <p class="edit-normal pl-0 pr-0 pb-3 pt-0 mt-0 mb-0 ml-0 mr-0"> @Html.DisplayFor(modelItem => item.InternalNotes)</p>

                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    }

                                }
                                ctr++;

                            }
                            <!-- sample examples -->


                        </table>
                    </div>
                </div>
            </div>


        </div>
    </div>
    @if (Model.Count > 0)
    {
        <div class="bottom-pagination">
            <div class="pagination">
                <div>


                </div>

                @Html.PagedListPager(Model, page => Url.Action("DisplayCollaborationHistoryList",
                new
                {
                    B7vy6imTleYsMr6Nlv7VQ =
                                                                STP.Web.Helpers.EncryptionUtility.Encrypt("page=" + page +
                                                                "&DocumentId=" + ViewBag.DocumentId)
                }),
                new PagedListRenderOptions
                {
                    DisplayLinkToPreviousPage = PagedListDisplayMode.IfNeeded,
                    DisplayLinkToNextPage = PagedListDisplayMode.IfNeeded,
                    LinkToPreviousPageFormat = "<img src='/Content/assets/images/left-chevlon.svg' width='10'>",
                    LinkToNextPageFormat = "<img src='/Content/assets/images/right-chevlon.svg' width='10'>",
                    DisplayLinkToFirstPage = PagedListDisplayMode.Never,
                    DisplayLinkToLastPage = PagedListDisplayMode.Never,
                    MaximumPageNumbersToDisplay = 3,
                    DisplayEllipsesWhenNotShowingAllPageNumbers = true,
                    EllipsesFormat = "..."
                })
            </div>
        </div>

    }
    else
    {
        <div class="redcolor aligncenter">@Resources.Resource.NoRecordFound</div>
    }
    
    {

</div>
@*<script src="~/Scripts/CspJs/Notification/DisplayCollaborationHistoryList.js?V@(Session["ProjectVersion"])"></script>*@
